<h3>Game setup</h3>
<p>
    {{game().GameSetup}}
</p>
<div data-bind="visible:  $root.game().GameState() == 'GameSetup'">
    Click a card to switch their character
</div>
<ul class="cards" data-bind="foreach: game().CharactersInGame">
    <li class="btn-group">
        <img class="card" data-bind="attr: { src: image, title: name, 'data-toggle': $root.game().GameState() == 'GameSetup' ? 'dropdown' : '' }" alt="{{$data}}" />
        <ul data-bind="foreach: $root.game().AllCharactersSelectList" class="dropdown-menu" role="menu">
            <li><a href="#" data-bind="click: $parent.setCharacter.bind($data, $parentContext.$index())">{{Text}}</a></li>
        </ul>
    </li>	
</ul>

<div class="clear"></div>    

<ul class="rules-table" data-bind="foreach: game().Rules">
	<li>{{$data}}</li>
</ul>

<ul class="round-table" data-bind="foreach: game().RoundTables">
    <li>{{$data}}</li>    
</ul>

<ul class="loyaltycards-table" data-bind="foreach: game().LoyaltyCardsDeltInAdvance">
    <li>{{$data}}</li>
</ul>

<div data-bind="visible: game().RoundTables().length == 0">
    This game only supports five to ten players
</div>

<div data-bind="visible: game().PlayerInfo">
    <h3>Oracle</h3>
    <p>Click any card to see the knowledge you have about that player</p>    
    <ul class="cards" data-bind="foreach: game().PlayerInfo">
		<li>
			<img class="playercard" data-bind="attr: { src: image }, click: toggleShowActual" />
            <div class="playername">{{Name}}</div>
		</li>
    </ul>
</div>

<div class="clear"></div>

<div data-bind="foreach: game().Rounds">
	<h3>
        {{Title}}
        <img  title="{{Outcome}}" data-bind="visible: Outcome, attr: { src: '/images/' + Outcome() + '.png' }" />
    </h3>
    <p>{{Summary}}</p>
	
    <div data-bind="foreach: Teams">
		<div class="quest">
            <div class="setup">
                <p>{{TeamSummary}}</p>
                <ul class="cards">                    
                    

                    <li data-bind="visible: HasExcalibur">                        
                        <img src="/Images/excaliburtoken.png" title="{{HasExcalibur}}" />
                        <div class="playername">{{HasExcalibur}}</div>
                    </li>

                    <!-- ko foreach: TeamMembers -->
                        <li>
                            <img src="/Images/teamtoken.png" title="{{$data}}" />
                            <div class="playername">{{$data}}</div>
                        </li>
                    
                    <!-- /ko -->
                     <!-- ko foreach: Vote -->
                        <li>
                            <img class="vote" title="{{Player}}" data-bind="attr: { src: '/images/' + Image() + '.png' }" />
                            <div class="playername">{{Player}}</div>
                        </li>
                    <!-- /ko -->

                </ul>
            </div>
            <div class="clear"></div>
            <div class="results">
                <ul class="cards" data-bind="foreach: QuestCards">                    
                    <li> 
                        <img class="card" data-bind="attr: { src: '/images/' + Image() + '.png' }" />
                    </li>                    
                </ul>

            </div>
            <div class="clear"></div>

            <!-- ko foreach: Messages -->
            <div class="message">
                <span>{{Player}}</span>: <span>{{Message}}</span>
            </div>
            <!-- /ko -->
		</div>
	</div>
    
    <div class="ladyofthelake">
        <ul class="cards" data-bind="foreach: LadyOfTheLakeUses">
            <li>
                <img src="/images/ladyofthelake.png" />
                <div class="playername">{{UsedBy}}</div>
            </li>
            <li>
                <img class="card" data-bind="attr: { src: '/images/' + Result() + '.png' }" />
                <div class="playername">{{UsedOn}}</div>
            </li>
        </ul>
    </div>
    <div class="clear"></div>     

    <div class="excalibur">
        <ul class="cards" data-bind="foreach: ExcaliburUses">
            <li>
                <img src="/images/excaliburtoken.png" />
                <div class="playername">{{UsedBy}}</div>
            </li>
            <li>
                <img class="card" data-bind="attr: { src: '/images/' + Result() + '.png' }" />
                <div class="playername">{{UsedOn}}</div>
            </li>
        </ul>
    </div>
    <div class="clear"></div>     

    <p data-bind="visible: LoyaltyCard!=null">
        {{LoyaltyCard}}
    </p>
    
</div>

<div data-bind="visible: game().AssassinsGuessAtMerlin">
    <h3>Guess at merlin</h3>
    {{game().AssassinsGuessAtMerlin != null ? game().AssassinsGuessAtMerlin.Name : ''}}
</div>

<div data-bind="visible: game().GameOver">
    <h3>Game Over</h3>
    <p>{{game().GameState}}</p>
</div>

<span class="warning">{{game().WaitingMessage}}</span>

<ul data-bind="foreach: game().Actions">
    <li >
        <!--todo find nicer syntax for this-->
        <div data-bind="compose: { model: '/app/widgets/' + $data + '.js', view: '/app/widgets/' + $data + '.html', activationData: $root.game }"></div>
    </li>
</ul>

